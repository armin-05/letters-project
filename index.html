<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shape Writer</title>
<style>
  body {
    background-color: white;
    overflow: hidden;
    margin: 0;
  }

  canvas {
    display: block;
    background: #fff;
    margin: 0 auto;
  }
</style>
</head>
<body>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let x = 100, y = 100;
const colSpacing = 150;
const rowSpacing = 150;
let currentRow = 0;
let currentCol = 0;
let history = [[[]]]; // stores shapes per column and row
let scale = 1;

function zoomOutIfNeeded() {
  const margin = 100;
  const maxX = (currentCol + 1) * colSpacing;
  const maxY = (currentRow + 1) * rowSpacing;
  if (maxX * scale > window.innerWidth - margin || maxY * scale > window.innerHeight - margin) {
    scale *= 0.9;
    ctx.setTransform(scale, 0, 0, scale, 0, 0);
  }
}

function drawShape(letter, posX, posY) {
  const size = 60;
  ctx.strokeStyle = "rgba(255,0,0,0.55)";
  ctx.lineWidth = 10;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.beginPath();

  switch (letter.toUpperCase()) {
    case 'Q':
      ctx.arc(posX, posY, size / 2, 0, Math.PI * 2);
      ctx.moveTo(posX - size / 2, posY);
      ctx.lineTo(posX + size / 2, posY);
      break;
    case 'W':
      for (let i = -1; i <= 1; i++) {
        ctx.moveTo(posX + i * 20, posY - 40);
        ctx.lineTo(posX + i * 20, posY + 40);
      }
      break;
    case 'E':
      for (let i = -1; i <= 1; i++) {
        ctx.moveTo(posX - 40, posY + i * 20);
        ctx.lineTo(posX + 40, posY + i * 20);
      }
      break;
    case 'R':
      ctx.moveTo(posX + 40, posY + 60);
      ctx.lineTo(posX + 40, posY - 60);
      ctx.lineTo(posX - 10, posY - 60);
      ctx.arc(posX - 10, posY - 30, 30, -Math.PI / 2, Math.PI / 2);
      ctx.moveTo(posX - 10, posY);
      ctx.lineTo(posX + 40, posY + 60);
      break;
    case 'T':
      ctx.moveTo(posX - 40, posY - 40);
      ctx.lineTo(posX + 40, posY - 40);
      ctx.moveTo(posX, posY - 40);
      ctx.lineTo(posX, posY + 40);
      break;
    case 'Y':
      ctx.moveTo(posX - 40, posY);
      ctx.lineTo(posX + 40, posY);
      ctx.moveTo(posX, posY - 40);
      ctx.lineTo(posX, posY + 40);
      break;
    case 'U':
      ctx.moveTo(posX - 40, posY - 10);
      ctx.lineTo(posX + 40, posY - 10);
      ctx.moveTo(posX - 40, posY + 10);
      ctx.lineTo(posX + 40, posY + 10);
      break;
    case 'I':
      ctx.moveTo(posX, posY - 40);
      ctx.lineTo(posX, posY + 40);
      break;
    case 'O':
      ctx.arc(posX, posY, size / 2, 0, Math.PI * 2);
      break;
    case 'P':
      ctx.moveTo(posX + 40, posY + 60);
      ctx.lineTo(posX + 40, posY - 60);
      ctx.lineTo(posX - 10, posY - 60);
      ctx.arc(posX - 10, posY - 30, 30, -Math.PI / 2, Math.PI / 2);
      break;
    case 'A':
      const h = Math.sqrt(3) * (size / 2);
      ctx.moveTo(posX, posY - h / 2);
      ctx.lineTo(posX - size / 2, posY + h / 2);
      ctx.lineTo(posX + size / 2, posY + h / 2);
      ctx.closePath();
      break;
    case 'S':
      ctx.moveTo(posX, posY - 20);
      ctx.arc(posX - 15, posY - 20, 20, 0, Math.PI * 2);
      ctx.moveTo(posX, posY + 40);
      ctx.arc(posX + 15, posY + 20, 20, 0, Math.PI * 2);
      break;
    case 'D':
      ctx.moveTo(posX - 40, posY - 20);
      ctx.bezierCurveTo(posX + 40, posY - 40, posX + 40, posY + 40, posX - 40, posY + 20);
      ctx.moveTo(posX + 40, posY - 20);
      ctx.bezierCurveTo(posX - 40, posY - 40, posX - 40, posY + 40, posX + 40, posY + 20);
      break;
    case 'F':
      ctx.moveTo(posX - 40, posY - 10);
      ctx.lineTo(posX + 40, posY - 10);
      ctx.moveTo(posX - 40, posY + 10);
      ctx.lineTo(posX + 40, posY + 10);
      break;
    case 'G':
      ctx.arc(posX, posY, 5, 0, Math.PI * 2);
      break;
    case 'H':
      ctx.moveTo(posX - 40, posY);
      ctx.lineTo(posX + 40, posY);
      ctx.moveTo(posX - 40, posY);
      ctx.lineTo(posX - 20, posY - 20);
      ctx.moveTo(posX + 40, posY);
      ctx.lineTo(posX + 20, posY - 20);
      break;
    case 'J':
      ctx.moveTo(posX - 30, posY - 40);
      ctx.lineTo(posX + 30, posY - 40);
      ctx.lineTo(posX + 30, posY + 20);
      ctx.arc(posX, posY + 20, 30, 0, Math.PI, false);
      break;
    case 'K':
      ctx.moveTo(posX + 40, posY - 60);
      ctx.lineTo(posX + 40, posY + 60);
      ctx.moveTo(posX + 40, posY);
      ctx.lineTo(posX - 20, posY - 40);
      ctx.moveTo(posX + 40, posY);
      ctx.lineTo(posX - 20, posY + 40);
      break;
    case 'L':
      ctx.moveTo(posX + 40, posY - 60);
      ctx.lineTo(posX + 40, posY + 60);
      ctx.lineTo(posX - 20, posY + 60);
      break;
    case 'Z':
      ctx.font = "bold 80px Arial";
      ctx.fillStyle = "rgba(255,0,0,0.55)";
      ctx.fillText("@", posX - 30, posY + 30);
      return;
    case 'X':
      ctx.moveTo(posX - 40, posY - 40);
      ctx.lineTo(posX - 10, posY - 10);
      ctx.moveTo(posX + 40, posY - 40);
      ctx.lineTo(posX + 10, posY - 10);
      ctx.moveTo(posX - 40, posY + 40);
      ctx.lineTo(posX - 10, posY + 10);
      ctx.moveTo(posX + 40, posY + 40);
      ctx.lineTo(posX + 10, posY + 10);
      break;
    case 'C':
      ctx.arc(posX, posY, 40, Math.PI / 2, -Math.PI / 2, true);
      break;
    case 'V':
      ctx.moveTo(posX - 40, posY - 40);
      ctx.lineTo(posX, posY + 40);
      ctx.lineTo(posX + 40, posY - 40);
      break;
    case 'B':
      ctx.moveTo(posX + 40, posY + 60);
      ctx.lineTo(posX + 40, posY - 60);
      ctx.lineTo(posX - 10, posY - 60);
      ctx.arc(posX - 10, posY - 30, 30, -Math.PI / 2, Math.PI / 2);
      ctx.moveTo(posX + 40, posY);
      ctx.lineTo(posX - 10, posY + 60);
      ctx.arc(posX - 10, posY + 30, 30, -Math.PI / 2, Math.PI / 2);
      break;
    case 'N':
      ctx.moveTo(posX, posY);
      ctx.bezierCurveTo(posX - 40, posY - 40, posX - 80, posY + 20, posX, posY + 60);
      ctx.bezierCurveTo(posX + 80, posY + 20, posX + 40, posY - 40, posX, posY);
      break;
    case 'M':
      ctx.moveTo(posX + 40, posY + 60);
      ctx.lineTo(posX + 40, posY - 60);
      ctx.lineTo(posX, posY);
      ctx.lineTo(posX - 40, posY - 60);
      ctx.lineTo(posX - 40, posY + 60);
      break;
  }

  ctx.stroke();
}

document.addEventListener('keydown', (e) => {
  const letter = e.key;

  if (/^[a-zA-Z]$/.test(letter)) {
    drawShape(letter, x, y);
    history[currentCol][currentRow].push(letter);
  } else if (letter === ' ') {
    currentRow++;
    if (!history[currentCol][currentRow]) history[currentCol][currentRow] = [];
    y += rowSpacing;
  } else if (letter === 'Enter') {
    currentCol++;
    currentRow = 0;
    if (!history[currentCol]) history[currentCol] = [[]];
    x += colSpacing;
    y = 100;
  } else if (letter === 'Backspace') {
    e.preventDefault();
    const currentShapes = history[currentCol][currentRow];
    if (currentShapes.length > 0) {
      history[currentCol][currentRow] = [];
      redraw();
    } else if (currentRow > 0) {
      currentRow--;
      y -= rowSpacing;
      redraw();
    } else if (currentCol > 0) {
      currentCol--;
      x -= colSpacing;
      currentRow = history[currentCol].length - 1;
      y = 100 + rowSpacing * currentRow;
      redraw();
    }
  }

  zoomOutIfNeeded();
});

function redraw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  for (let c = 0; c < history.length; c++) {
    for (let r = 0; r < history[c].length; r++) {
      const letters = history[c][r];
      letters.forEach(l => drawShape(l, 100 + c * colSpacing, 100 + r * rowSpacing));
    }
  }
}
</script>
</body>
</html>
